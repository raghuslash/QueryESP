{
    "query" : {
    "bool": {
      "must": [
        {
          "match": {
            "device": "screenprinter"
          }
        },
        {
          "match": {
            "event": 1
          }
        }
      ],
      "filter": {
        "range": {
          "timestamp": {
            "gte": "now-7d"
          }
        }
      }
}
},
    
    // "_source" : ["energy", "working_time"],

    // "script_fields" : {
    //     "power" : {
    //         "script" : {
    //             "lang": "painless",
    //             "source": "doc['energy'].value*3600000 / doc['working_time'].value"
    //         }
    //     }
    // },

    "aggs": {
	    "avg_power": {
		    "avg": {
			    "script": {
				    "source": "doc['energy'].value*3600000 / doc['working_time'].value"
			    }
		    }
	    }
    }
}
