{"query":{"bool":{"must":[{"match":{"device":"pickandplace1"}},{"match":{"event":0}}],"filter":{"range":{"timestamp":{"gte":"now-60m"}}}}},"_source":["energy","working_time"],"script_fields":{"power":{"script":{"lang":"painless","source":"doc['energy'].value*3600000 / doc['working_time'].value"}}},"aggs":{"pick_and_place_1_idle_delay":{"avg":{"field":"working_time"}},"pick_and_place_1_idle_energy":{"avg":{"field":"energy"}},"pick_and_place_1_idle_power":{"avg":{"script":{"source":"doc['energy'].value*3600000 / doc['working_time'].value"}}}}}