{"query":{"bool":{"must":[{"match":{"device":"pickandplace1"}},{"match":{"event":1}}],"size":40,"sort":[{"timestamp":{"order":"desc"}}]}},"_source":["energy","working_time"],"script_fields":{"power":{"script":{"lang":"painless","source":"doc['energy'].value*3600000 / doc['working_time'].value"}}},"aggs":{"pick_and_place_1_processing_delay":{"avg":{"field":"working_time"}},"pick_and_place_1_processing_energy":{"avg":{"field":"energy"}},"pick_and_place_1_processing_power":{"avg":{"script":{"source":"doc['energy'].value*3600000 / doc['working_time'].value"}}}}}